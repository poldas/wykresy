(function(){"use strict";var t=function(t){t=t||{};var e={},n=function(t,e){t.replace(/\S+/g,e)},i=function(e,n){Object.defineProperty(t,e,{value:n,enumerable:false,writable:false,configurable:false})};i("on",function(i,r){if(typeof r!="function")return t;n(i,function(t,n){(e[t]=e[t]||[]).push(r);r.typed=n>0});return t});i("off",function(i,r){if(i=="*")e={};else{n(i,function(t){if(r){var n=e[t];for(var i=0,f;f=n&&n[i];++i){if(f==r)n.splice(i--,1)}}else delete e[t]})}return t});i("one",function(e,n){function i(){t.off(e,i);n.apply(t,arguments)}return t.on(e,i)});i("trigger",function(i){var r=arguments.length-1,f=new Array(r);for(var u=0;u<r;u++){f[u]=arguments[u+1]}n(i,function(n){var i=(e[n]||[]).slice(0);for(var r=0,u;u=i[r];++r){if(u.busy)return;u.busy=1;try{u.apply(t,u.typed?[n].concat(f):f)}catch(o){}if(i[r]!==u){r--}u.busy=0}if(e.all&&n!="all")t.trigger.apply(t,["all",n].concat(f))});return t});return t};var e=/^.+?\/+[^\/]+/,n="EventListener",i="remove"+n,r="add"+n,f="hasAttribute",u="replace",o="popstate",a="hashchange",c="trigger",s=3,l=typeof window!="undefined"&&window,h=typeof document!="undefined"&&document,p=l&&history,d=l&&(p.location||l.location),m=j.prototype,v=h&&h.ontouchstart?"touchstart":"click",y=false,g=t(),b=false,w,$,x,A,K,N=[],O=0;function S(t){return t.split(/[\/?#]/)}function T(t,e){var n=new RegExp("^"+e[u](/\*/g,"([^/?#]+?)")[u](/\.\./,".*")+"$"),i=t.match(n);if(i)return i.slice(1)}function E(t,e){var n;return function(){clearTimeout(n);n=setTimeout(t,e)}}function P(t){w=E(R,1);l[r](o,w);l[r](a,w);h[r](v,_);if(t)R(true)}function j(){this.$=[];t(this);g.on("stop",this.s.bind(this));g.on("emit",this.e.bind(this))}function k(t){return t[u](/^\/|\/$/,"")}function q(t){return typeof t=="string"}function D(t){return(t||d.href||"")[u](e,"")}function L(t){return $[0]=="#"?(t||d.href||"").split($)[1]||"":D(t)[u]($,"")}function R(t){var e=O==0;if(s<=O)return;O++;N.push(function(){var e=L();if(t||e!=x){g[c]("emit",e);x=e}});if(e){while(N.length){N[0]();N.shift()}O=0}}function _(t){if(t.which!=1||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;var n=t.target;while(n&&n.nodeName!="A")n=n.parentNode;if(!n||n.nodeName!="A"||n[f]("download")||!n[f]("href")||n.target&&n.target!="_self"||n.href.indexOf(d.href.match(e)[0])==-1)return;if(n.href!=d.href){if(n.href.split("#")[0]==d.href.split("#")[0]||$!="#"&&D(n.href).indexOf($)!==0||!z(L(n.href),n.title||h.title))return}t.preventDefault()}function z(t,e){if(p){e=e||h.title;p.pushState(null,e,$+k(t));h.title=e;b=false;R();return b}return g[c]("emit",L(t))}m.m=function(t,e){if(q(t)&&(!e||q(e)))z(t,e);else if(e)this.r(t,e);else this.r("@",t)};m.s=function(){this.off("*");this.$=[]};m.e=function(t){this.$.concat("@").some(function(e){var n=(e=="@"?A:K)(k(t),k(e));if(typeof n!="undefined"){this[c].apply(null,[e].concat(n));return b=true}},this)};m.r=function(t,e){if(t!="@"){t="/"+k(t);this.$.push(t)}this.on(t,e)};var B=new j;var C=B.m.bind(B);C.create=function(){var t=new j;t.m.stop=t.s.bind(t);return t.m.bind(t)};C.base=function(t){$=t||"#";x=L()};C.exec=function(){R(true)};C.parser=function(t,e){if(!t&&!e){A=S;K=T}if(t)A=t;if(e)K=e};C.query=function(){var t={};var e=d.href||x;e[u](/[?&](.+?)=([^&]*)/g,function(e,n,i){t[n]=i});return t};C.stop=function(){if(y){if(l){l[i](o,w);l[i](a,w);h[i](v,_)}g[c]("stop");y=false}};C.start=function(t){if(!y){if(l){if(document.readyState=="complete")P(t);else l[r]("load",function(){setTimeout(function(){P(t)},1)})}y=true}};C.base();C.parser();window.route=C})();